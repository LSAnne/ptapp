<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Client Login / Signup</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background:#0f1113; color:#fff; }
    .auth-card { max-width: 420px; margin: 5rem auto; padding: 2rem; background:#15181c; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,.35); }
    .toggle-link { cursor: pointer; color:#0d6efd; text-decoration: underline; }
  </style>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="css/theme.css" rel="stylesheet"><!-- or theme.css if in root -->
</head>
<body class="app-bg">
<main class="auth-card">
  <h1 id="formTitle" class="mb-3">Client Login</h1>
  <div id="alert" class="alert d-none"></div>

  <!-- Login form -->
  <form id="loginForm">
    <div class="mb-3">
      <label>Email</label>
      <input type="email" id="loginEmail" class="form-control" required />
    </div>
    <div class="mb-3">
      <label>Password</label>
      <input type="password" id="loginPassword" class="form-control" required />
    </div>
    <button class="btn btn-primary w-100">Log In</button>
    <p class="mt-3">Don't have an account? <span id="showSignup" class="toggle-link">Sign up</span></p>
  </form>

  <!-- Signup form (hidden by default) -->
  <form id="signupForm" class="d-none">
    <div class="mb-3">
      <label>Email</label>
      <input type="email" id="signupEmail" class="form-control" required />
    </div>
    <div class="mb-3">
      <label>Password (min 6 chars)</label>
      <input type="password" id="signupPassword" class="form-control" required minlength="6" />
    </div>
    <button class="btn btn-success w-100">Sign Up</button>
    <p class="mt-3">Already have an account? <span id="showLogin" class="toggle-link">Log in</span></p>
  </form>
</main>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabase = window.supabase.createClient(
    "https://ukqmpkzljwiwpyvygrai.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVrcW1wa3psandpd3B5dnlncmFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyMjk1MTAsImV4cCI6MjA2OTgwNTUxMH0.4H3XnW4tYSDofnFeSoEBqACVFh1Ud5sI8bXsnEsiu4E"
  );

  const alertBox = document.getElementById("alert");
  function showAlert(type, msg) {
    alertBox.className = `alert alert-${type}`;
    alertBox.textContent = msg;
    alertBox.classList.remove("d-none");
  }

  // Toggle between forms
  document.getElementById("showSignup").addEventListener("click", () => {
    document.getElementById("loginForm").classList.add("d-none");
    document.getElementById("signupForm").classList.remove("d-none");
    document.getElementById("formTitle").textContent = "Client Signup";
  });

  document.getElementById("showLogin").addEventListener("click", () => {
    document.getElementById("signupForm").classList.add("d-none");
    document.getElementById("loginForm").classList.remove("d-none");
    document.getElementById("formTitle").textContent = "Client Login";
  });

  // Login form submit
  document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;

    const { error } = await supabase.auth.signInWithPassword({ email, password });

    if (error) {
      showAlert("danger", error.message);
    } else {
      showAlert("success", "Logged in! Redirecting...");
      setTimeout(() => window.location.href = "client-dashboard.html", 800);
    }
  });

  // Signup form submit
  document.getElementById("signupForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("signupEmail").value;
    const password = document.getElementById("signupPassword").value;

    const { error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        emailRedirectTo: window.location.origin + "/client-login.html"
      }
    });

    if (error) {
      showAlert("danger", error.message);
    } else {
      showAlert("success", "Signup successful! Check your email to confirm before logging in.");
    }
  });
</script>
</body>
</html>